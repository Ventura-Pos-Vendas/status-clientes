<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meus Casos</title>
    <style>
/* Estilos do Login */
.login-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
}

.login-container {
    background: white;
    padding: 40px;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    max-width: 400px;
    width: 90%;
    text-align: center;
}

.login-container h2 {
    color: #2c3e50;
    margin-bottom: 10px;
    font-size: 28px;
}

.login-container p {
    color: #6c757d;
    margin-bottom: 30px;
}

.login-input {
    width: 100%;
    padding: 15px;
    border: 2px solid #3498db;
    border-radius: 8px;
    font-size: 16px;
    margin-bottom: 20px;
    outline: none;
    transition: border-color 0.3s;
}

.login-input:focus {
    border-color: #2980b9;
}

.login-btn {
    background: #27ae60;
    color: white;
    border: none;
    padding: 15px 30px;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    width: 100%;
    transition: background 0.3s;
}

.login-btn:hover {
    background: #219a52;
}

.login-btn:disabled {
    background: #95a5a6;
    cursor: not-allowed;
}

.error-message {
    color: #e74c3c;
    margin-top: 15px;
    display: none;
}

/* Estilos existentes do sistema */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: #333;
    line-height: 1.6;
    padding: 20px;
    min-height: 100vh;
    overflow: hidden;
}

.container {
    max-width: 1000px;
    margin: 0 auto;
    background-color: white;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    overflow: hidden;
    height: calc(100vh - 40px);
    display: flex;
    flex-direction: column;
}

header {
    background: #2c3e50;
    color: white;
    padding: 25px;
    text-align: center;
    flex-shrink: 0;
}

h1 {
    font-size: 28px;
    margin-bottom: 0;
}

.tabs {
    display: flex;
    background: #34495e;
    flex-shrink: 0;
}

.tab {
    flex: 1;
    padding: 15px;
    text-align: center;
    background: #34495e;
    color: white;
    border: none;
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
    transition: background 0.3s;
}

.tab:hover {
    background: #3c556d;
}

.tab.active {
    background: #3498db;
}

.search-container {
    padding: 20px;
    background: #f8f9fa;
    border-bottom: 1px solid #e9ecef;
    flex-shrink: 0;
}

.search-box {
    display: flex;
    max-width: 500px;
    margin: 0 auto;
}

.search-box input {
    flex: 1;
    padding: 12px 15px;
    border: 2px solid #3498db;
    border-radius: 8px;
    font-size: 16px;
    outline: none;
    transition: border-color 0.3s;
}

.search-box input:focus {
    border-color: #2980b9;
}

.refresh-btn {
    background: #27ae60;
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    margin-left: 10px;
    cursor: pointer;
    font-weight: 600;
    transition: background 0.3s;
}

.refresh-btn:hover {
    background: #219a52;
}

.cases-container {
    flex: 1;
    overflow-y: auto;
    padding: 0;
}

.case-item {
    padding: 18px 20px;
    border-bottom: 1px solid #e9ecef;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: background 0.2s;
    cursor: pointer;
}

.case-item:hover {
    background: #f8f9fa;
}

.case-info {
    flex: 1;
}

.case-title {
    font-weight: 600;
    font-size: 18px;
    margin-bottom: 5px;
    color: #2c3e50;
}

.case-details {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    color: #6c757d;
    font-size: 14px;
}

.case-details span {
    white-space: nowrap;
}

.case-status {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
}

/* Status de cores */
.status-bo {
    background-color: #000000 !important;
    color: white !important;
}

.status-faturado {
    background-color: #28a745 !important;
    color: white !important;
}

.status-encomendado {
    background-color: #fd7e14 !important;
    color: white !important;
}

.status-faturado-encomendado {
    background-color: #007bff !important;
    color: white !important;
}

.status-em-processamento {
    background-color: #ffc107 !important;
    color: #212529 !important;
}

.status-em-analise {
    background-color: #ffc107 !important;
    color: #212529 !important;
}

.status-aprovado {
    background-color: #28a745 !important;
    color: white !important;
}

.status-recusado {
    background-color: #dc3545 !important;
    color: white !important;
}

.status-aguardando-envio {
    background-color: #6f42c1 !important;
    color: white !important;
}

.status-default {
    background-color: #fff3cd !important;
    color: #856404 !important;
}

.loading {
    text-align: center;
    padding: 40px;
    font-size: 18px;
    color: #3498db;
}

.error {
    text-align: center;
    padding: 40px;
    background-color: #f8d7da;
    color: #721c24;
    border-radius: 8px;
    margin: 20px;
}

.empty {
    text-align: center;
    padding: 40px;
    color: #6c757d;
    font-style: italic;
}

.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 1000;
    align-items: center;
    justify-content: center;
}

.modal-content {
    background: white;
    padding: 30px;
    border-radius: 10px;
    max-width: 700px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    border-bottom: 1px solid #e9ecef;
    padding-bottom: 15px;
}

.modal-title {
    font-size: 20px;
    font-weight: 600;
    color: #2c3e50;
}

.close-btn {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #6c757d;
}

.modal-details {
    margin-bottom: 20px;
}

.modal-detail {
    margin-bottom: 15px;
    display: flex;
    align-items: flex-start;
}

.modal-detail strong {
    width: 160px;
    color: #495057;
    flex-shrink: 0;
    margin-right: 15px;
}

.modal-detail span {
    flex: 1;
    word-break: break-word;
}

.modal-description {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 5px;
    border-left: 4px solid #3498db;
    white-space: pre-line;
    line-height: 1.5;
    word-wrap: break-word;
    overflow-wrap: break-word;
}

/* Estilos para os botões de ação do BO */
.bo-actions {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 20px;
    width: 100%;
}

.bo-action-btn {
    padding: 12px;
    border: none;
    border-radius: 6px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: all 0.3s;
    width: 100%;
}

.action-faturar-encomendar {
    background: #28a745;
    color: white;
}

.action-faturar-encomendar:hover {
    background: #218838;
}

.action-faturar-disponiveis {
    background: #007bff;
    color: white;
}

.action-faturar-disponiveis:hover {
    background: #0056b3;
}

.action-cancelar {
    background: #dc3545;
    color: white;
}

.action-cancelar:hover {
    background: #c82333;
}

footer {
    text-align: center;
    padding: 15px;
    background: #f8f9fa;
    color: #6c757d;
    font-size: 14px;
    border-top: 1px solid #e9ecef;
    flex-shrink: 0;
}

.logout-btn {
    background: #e74c3c;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 12px;
    margin-left: 10px;
}

@media (max-width: 600px) {
    .case-item {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .case-status {
        margin-top: 10px;
        align-self: flex-end;
    }
    
    .case-details {
        flex-direction: column;
        gap: 8px;
    }
    
    .search-box {
        flex-direction: column;
    }
    
    .refresh-btn {
        margin-left: 0;
        margin-top: 10px;
    }
    
    .modal-content {
        padding: 20px;
        margin: 20px;
    }
    
    .modal-detail {
        flex-direction: column;
        gap: 5px;
    }
    
    .modal-detail strong {
        width: auto;
        margin-right: 0;
    }
    
    .modal-detail span {
        width: 100%;
    }
    
    .bo-actions {
        flex-direction: column;
    }
}
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Tela de Login -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-container">
            <h2>Acesso do Cliente</h2>
            <p>Digite seu login para visualizar seus casos</p>
            
            <input type="text" id="loginInput" class="login-input" placeholder="Digite seu login" autocomplete="off">
            
            <button id="loginBtn" class="login-btn">
                Acessar Meus Casos
            </button>
            
            <div id="loginError" class="error-message">
                Login não encontrado. Verifique se digitou corretamente.
            </div>
        </div>
    </div>

    <!-- Sistema Principal (inicialmente escondido) -->
    <div class="container" id="mainContainer" style="display: none;">
        <header>
            <h1 id="headerTitle">Meus Casos</h1>
        </header>
        
        <div class="tabs">
            <button class="tab active" data-tab="vendas">Vendas</button>
            <button class="tab" data-tab="garantias">Garantias</button>
        </div>
        
        <div class="search-container">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Buscar por caso, nome ou status...">
                <button class="refresh-btn" id="refreshBtn">Atualizar</button>
            </div>
        </div>
        
        <div class="cases-container" id="casesContainer">
            <div class="loading" id="loadingMessage">
                Carregando dados...
            </div>
        </div>
        
        <footer id="mainFooter">
            Sistema de Gestão
        </footer>
    </div>

    <!-- Modal para mostrar detalhes -->
    <div class="modal" id="caseModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Detalhes do Caso</h3>
                <button class="close-btn" id="closeModal">&times;</button>
            </div>
            <div class="modal-details">
                <div class="modal-detail">
                    <strong>Data:</strong>
                    <span id="modalDate"></span>
                </div>
                <div class="modal-detail">
                    <strong>Nome:</strong>
                    <span id="modalName"></span>
                </div>
                <div class="modal-detail">
                    <strong>Status:</strong>
                    <span id="modalStatus"></span>
                </div>
            </div>
            <div>
                <strong>Descrição:</strong>
                <div class="modal-description" id="modalDescription">
                    Carregando descrição...
                </div>
            </div>
            <!-- Botões específicos para status BO -->
            <div class="bo-actions" id="boActions" style="display: none;">
                <button class="bo-action-btn action-faturar-encomendar" onclick="handleBoAction('faturar-encomendar')">
                    <i class="fas fa-check-circle"></i>
                    FATURAR DISPONÍVEIS E ENCOMENDAR RESTANTE
                </button>
                <button class="bo-action-btn action-faturar-disponiveis" onclick="handleBoAction('faturar-disponiveis')">
                    <i class="fas fa-check"></i>
                    FATURAR SOMENTE DISPONÍVEIS
                </button>
                <button class="bo-action-btn action-cancelar" onclick="handleBoAction('cancelar')">
                    <i class="fas fa-times-circle"></i>
                    CANCELAR PEDIDO
                </button>
            </div>
        </div>
    </div>

    <script>
        // Variáveis globais
        let currentTab = 'vendas';
        let allData = { vendas: [], garantias: [], logins: [] };
        let currentCaseData = null;
        let clienteLogado = null;
        let clienteKeys = [];

        // Elementos
        const loginOverlay = document.getElementById('loginOverlay');
        const mainContainer = document.getElementById('mainContainer');
        const loginInput = document.getElementById('loginInput');
        const loginBtn = document.getElementById('loginBtn');
        const loginError = document.getElementById('loginError');
        const headerTitle = document.getElementById('headerTitle');
        const mainFooter = document.getElementById('mainFooter');
        const searchInput = document.getElementById('searchInput');
        const casesContainer = document.getElementById('casesContainer');
        const loadingMessage = document.getElementById('loadingMessage');
        const refreshBtn = document.getElementById('refreshBtn');
        const tabs = document.querySelectorAll('.tab');
        const caseModal = document.getElementById('caseModal');
        const closeModal = document.getElementById('closeModal');
        const boActions = document.getElementById('boActions');

        // URL do Google Apps Script
        const API_URL = "https://script.google.com/macros/s/AKfycbzegei8cOB6IXOSNvOHVUotFItvLG4rwkN4Wmpj4mnUDHlZL_KwE97oazTExdOEseNLtg/exec";

        // Event Listeners
        loginBtn.addEventListener('click', handleLogin);
        loginInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') handleLogin();
        });

        // Função de login
        function handleLogin() {
            const login = loginInput.value.trim();
            
            if (!login) {
                showLoginError('Por favor, digite seu login');
                return;
            }
            
            // Verificar se os dados já foram carregados
            if (allData.logins.length === 0) {
                loadAllData(login);
            } else {
                verifyLogin(login);
            }
        }

        // Função para verificar login e obter keys
        function verifyLogin(login) {
            // Buscar o login na estrutura de dados
            const loginData = allData.logins.find(item => 
                item.login && item.login.toLowerCase() === login.toLowerCase()
            );
            
            console.log('Dados do login:', loginData);
            
            if (loginData && loginData.keys && loginData.keys.length > 0) {
                clienteKeys = loginData.keys;
                loginSuccess(login);
            } else {
                showLoginError('Login não encontrado ou sem keys vinculadas.');
            }
        }

        // Login bem-sucedido
        function loginSuccess(login) {
            clienteLogado = login;
            loginOverlay.style.display = 'none';
            mainContainer.style.display = 'flex';
            
            // Deixar apenas "Meus Casos" no título
            headerTitle.innerHTML = `Meus Casos`;
            
            // Atualizar rodapé
            mainFooter.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span>Sistema de Gestão</span>
                    <button class="logout-btn" id="logoutBtn">Sair</button>
                </div>
            `;
            
            // Event listener para logout
            document.getElementById('logoutBtn').addEventListener('click', function() {
                clienteLogado = null;
                clienteKeys = [];
                mainContainer.style.display = 'none';
                loginOverlay.style.display = 'flex';
                loginInput.value = '';
                loginError.style.display = 'none';
            });
            
            // MOSTRAR CASOS IMEDIATAMENTE APÓS LOGIN
            displayCases(allData[currentTab]);
        }

        // Mostrar erro de login
        function showLoginError(message) {
            loginError.textContent = message;
            loginError.style.display = 'block';
        }

        // Função para carregar todos os dados usando JSONP
        function loadAllData(login = null) {
            loadingMessage.textContent = 'Carregando dados...';
            loadingMessage.style.display = 'block';
            
            const timestamp = new Date().getTime();
            const callbackName = 'jsonpCallback_' + timestamp;
            
            window[callbackName] = function(data) {
                console.log('Dados recebidos:', data);
                
                allData.vendas = data.vendas || [];
                allData.garantias = data.garantias || [];
                allData.logins = data.logins || [];
                
                // Debug: verificar estrutura dos dados
                console.log('Logins disponíveis:', allData.logins);
                console.log('Estrutura do primeiro caso de vendas:', allData.vendas[0]);
                
                if (login) {
                    verifyLogin(login);
                } else {
                    loadingMessage.style.display = 'none';
                }
                
                delete window[callbackName];
            };
            
            const script = document.createElement('script');
            script.src = `${API_URL}?callback=${callbackName}&t=${timestamp}`;
            script.onerror = function() {
                loadingMessage.innerHTML = '<div class="error">Erro ao carregar dados. Tente novamente.</div>';
                delete window[callbackName];
            };
            
            document.head.appendChild(script);
        }

        // Event Listeners para as abas
        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                tabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                currentTab = this.dataset.tab;
                displayCases(allData[currentTab]);
            });
        });

        // Event Listener para atualizar
        refreshBtn.addEventListener('click', function() {
            loadingMessage.textContent = 'Atualizando dados...';
            loadingMessage.style.display = 'block';
            loadAllData();
        });

        // Event Listeners para o modal
        closeModal.addEventListener('click', function() {
            caseModal.style.display = 'none';
        });

        caseModal.addEventListener('click', function(e) {
            if (e.target === caseModal) {
                caseModal.style.display = 'none';
            }
        });

        // Função para lidar com ações do BO
        function handleBoAction(action) {
            if (!currentCaseData) return;
            
            let message = '';
            
            switch(action) {
                case 'faturar-encomendar':
                    message = `Olá! Referente ao caso *${currentCaseData.caso}* que está com status BO.\n\n` +
                             `*Solicito:* FATURAR DISPONÍVEIS E ENCOMENDAR RESTANTE\n\n` +
                             `*Detalhes do caso:*\n` +
                             `Data: ${formatDate(currentCaseData.data)}\n` +
                             `Nome: ${currentCaseData.nome || 'Não informado'}\n` +
                             `Descrição: ${currentCaseData.descricao || 'Sem descrição'}`;
                    break;
                    
                case 'faturar-disponiveis':
                    message = `Olá! Referente ao caso *${currentCaseData.caso}* que está com status BO.\n\n` +
                             `*Solicito:* FATURAR SOMENTE DISPONÍVEIS\n` +
                             `Os itens indisponíveis devem ser cancelados.\n\n` +
                             `*Detalhes do caso:*\n` +
                             `Data: ${formatDate(currentCaseData.data)}\n` +
                             `Nome: ${currentCaseData.nome || 'Não informado'}\n` +
                             `Descrição: ${currentCaseData.descricao || 'Sem descrição'}`;
                    break;
                    
                case 'cancelar':
                    message = `Olá! Referente ao caso *${currentCaseData.caso}* que está com status BO.\n\n` +
                             `*Solicito:* CANCELAR PEDIDO\n\n` +
                             `*Detalhes do caso:*\n` +
                             `Data: ${formatDate(currentCaseData.data)}\n` +
                             `Nome: ${currentCaseData.nome || 'Não informado'}\n` +
                             `Descrição: ${currentCaseData.descricao || 'Sem descrição'}`;
                    break;
            }
            
            const phoneNumber = "5516996174440";
            const encodedMessage = encodeURIComponent(message);
            const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodedMessage}`;
            window.open(whatsappUrl, '_blank');
        }

        // Função para obter casos do cliente baseado nas keys
        function getClientCases(cases) {
            return cases.filter(item => {
                const itemKey = item.key ? String(item.key).trim() : '';
                return clienteKeys.some(clientKey => 
                    clientKey.toLowerCase() === itemKey.toLowerCase()
                );
            });
        }

        // Função para exibir os casos (FILTRADA POR MULTIPLAS KEYS)
        function displayCases(cases) {
            if (!cases || cases.length === 0) {
                casesContainer.innerHTML = '<div class="empty">Nenhum caso encontrado</div>';
                return;
            }
            
            // Filtrar casos baseado nas keys do cliente
            let filteredCases = getClientCases(cases);
            
            if (filteredCases.length === 0) {
                casesContainer.innerHTML = '<div class="empty">Nenhum caso encontrado para você</div>';
                return;
            }
            
            renderCases(filteredCases);
        }

        // Função para renderizar os casos na tela
        function renderCases(cases) {
            let html = '';
            cases.forEach((item, index) => {
                const statusClass = getStatusClass(item.status);
                
                html += `
                    <div class="case-item" data-index="${index}">
                        <div class="case-info">
                            <div class="case-title">Caso: ${item.caso || 'Sem título'}</div>
                            <div class="case-details">
                                <span><strong>Data:</strong> ${formatDate(item.data)}</span>
                                <span><strong>Nome:</strong> ${item.nome || 'Não informado'}</span>
                            </div>
                        </div>
                        <div class="case-status ${statusClass}">${item.status || 'Pendente'}</div>
                    </div>
                `;
            });
            
            casesContainer.innerHTML = html;
            
            document.querySelectorAll('.case-item').forEach(item => {
                item.addEventListener('click', function() {
                    const index = this.dataset.index;
                    showCaseDetails(cases[index]);
                });
            });
        }

        // Função para mostrar detalhes do caso
        function showCaseDetails(caseData) {
            currentCaseData = caseData;
            document.getElementById('modalTitle').textContent = `CASO: ${caseData.caso || 'Sem título'}`;
            document.getElementById('modalDate').textContent = formatDate(caseData.data);
            document.getElementById('modalName').textContent = caseData.nome || 'Não informado';
            document.getElementById('modalStatus').textContent = caseData.status || 'Pendente';
            document.getElementById('modalStatus').className = 'case-status ' + getStatusClass(caseData.status);
            document.getElementById('modalDescription').textContent = caseData.descricao || 'Sem descrição';
            
            // Mostrar botões específicos para BO
            if (caseData.status && caseData.status.toUpperCase() === 'BO') {
                boActions.style.display = 'flex';
            } else {
                boActions.style.display = 'none';
            }
            
            caseModal.style.display = 'flex';
        }

        // FUNÇÃO DE FILTRO CORRIGIDA - busca mais precisa
        function filterCases() {
            const searchTerm = searchInput.value.toLowerCase().trim();
            
            if (!searchTerm) {
                // Se não há termo de busca, mostrar todos os casos do cliente
                displayCases(allData[currentTab]);
                return;
            }
            
            // Obter todos os casos do cliente
            const allClientCases = getClientCases(allData[currentTab]);
            
            if (allClientCases.length === 0) {
                casesContainer.innerHTML = '<div class="empty">Nenhum caso encontrado para você</div>';
                return;
            }
            
            // Filtrar casos baseado no termo de busca
            const filteredCases = allClientCases.filter(item => {
                const searchableFields = [
                    item.caso || '',
                    item.nome || '',
                    item.status || '',
                    item.data ? formatDate(item.data) : '',
                    item.descricao || ''
                ];
                
                return searchableFields.some(field => 
                    field.toString().toLowerCase().includes(searchTerm)
                );
            });
            
            // Mostrar resultados
            if (filteredCases.length === 0) {
                casesContainer.innerHTML = '<div class="empty">Nenhum caso encontrado com esses critérios de busca</div>';
            } else {
                renderCases(filteredCases);
            }
        }

        // Função para formatar data
        function formatDate(dateString) {
            if (!dateString) return 'Não informada';
            if (/^\d{4}-\d{2}-\d{2}$/.test(dateString)) return dateString;
            const date = new Date(dateString);
            if (!isNaN(date.getTime())) return date.toLocaleDateString('pt-BR');
            return dateString;
        }

        // Função para obter a classe CSS baseada no status
        function getStatusClass(status) {
            if (!status) return 'status-default';
            const statusUpper = status.toUpperCase();
            
            // Mapeamento dos status com cores
            const statusMap = {
                'BO': 'status-bo',
                'FATURADO': 'status-faturado',
                'ENCOMENDADO': 'status-encomendado',
                'FATURADO/ENCOMENDADO': 'status-faturado-encomendado',
                'FATURADO ENCOMENDADO': 'status-faturado-encomendado',
                'EM PROCESSAMENTO': 'status-em-processamento',
                'EM PROCESSO': 'status-em-processamento',
                'PROCESSANDO': 'status-em-processamento',
                'EM ANÁLISE': 'status-em-analise',
                'ANALISE': 'status-em-analise',
                'ANÁLISE': 'status-em-analise',
                'APROVADO': 'status-aprovado',
                'RECUSADO': 'status-recusado',
                'AGUARDANDO ENVIO': 'status-aguardando-envio',
                'AGUARDANDO': 'status-aguardando-envio'
            };
            
            // Primeiro verifica se há correspondência exata
            if (statusMap[statusUpper]) {
                return statusMap[statusUpper];
            }
            
            // Se não houver correspondência exata, verifica se contém a palavra
            for (const [key, value] of Object.entries(statusMap)) {
                if (statusUpper.includes(key)) {
                    return value;
                }
            }
            
            return 'status-default';
        }

        // Event Listener para filtro em tempo real
        searchInput.addEventListener('input', filterCases);

        // Carregar dados ao iniciar (sem login ainda)
        loadAllData();
    </script>
</body>
</html>